{"version":3,"file":"utils.umd.js","sources":["../src/math.js","../src/time.js","../src/animation.js","../src/array.js","../src/canvas.js","../src/dom.js","../src/file.js","../src/object.js","../src/string.js","../src/storage.js","../src/promise.js","../src/url.js","../src/MapExtended.js"],"sourcesContent":["/**\n * Linear interpolation, maps the amount between 0 and 1 to a range between start and stop\n * @param  {number} start\n * @param  {number} stop\n * @param  {number} amount\n * @returns  {number} Returns the mapped value\n */\nexport function lerp(start, stop, amount) {\n  return amount * (stop - start) + start\n}\n\n/**\n * Inverse of the lerp() function\n * @param  {number} start\n * @param  {number} stop\n * @param  {number} amount\n * @returns  {number} Returns the value mapped between 0 and 1\n */\nexport function lerpInv(start, stop, amount) {\n  return (amount - start) / (stop - start)\n}\n\n// angles\nexport const TAU = 2 * Math.PI\nexport const QUARTER_PI = Math.PI * 0.5\n\nexport function toRadians(degrees) {\n  return degrees * (Math.PI / 180)\n}\n\nexport function toDegrees(radians) {\n  return radians * (180 / Math.PI)\n}\n\nexport function getDeltaAngle(current, target) {\n  const a = modulo((current - target), TAU);\n  const b = modulo((target - current), TAU);\n  return a < b ? -a : b;\n}\n\n/**\n * Exponential Lerp, distance between 0.125 and 0.25 is now exactly the same as the distance between 4 and 8\n * @param {number} a start\n * @param {number} b end\n * @param {number} t amount\n * @author freyaholmer\n * @author khyperia\n * @returns {number}\n */\nexport function lerpExp(a, b, t) {\n  return a * Math.pow(b / a, t)\n}\n\n/**\n * Lerp for Scale/Zooming {@link https://gamedev.stackexchange.com/questions/4093/zooming-and-panning-a-camera-simultaneously-causes-a-swooping-effect more}.\n * @param {number} a start\n * @param {number} b end\n * @param {number} t amount\n * @returns {number}\n */\nexport function lerpScale(a, b, t) {\n  return 1 / (t * (1 / b - 1 / a) + 1 / a)\n}\n\nexport function smoothDamp(\n  current,\n  target,\n  velocity,\n  smoothTime = 100,\n  maxSpeed = Infinity,\n  deltaTime = 0\n) {\n  let num = 2 / (smoothTime || 0.00001)\n  let num2 = num * deltaTime\n  let num3 = 1 / (1 + num2 + 0.48 * num2 * num2 + 0.235 * num2 * num2 * num2)\n  let num4 = current - target\n  let num5 = target\n  let num6 = maxSpeed * smoothTime\n  num4 = clamp(num4, -num6, num6)\n  target = current - num4\n  let num7 = (velocity + num * num4) * deltaTime\n  velocity = (velocity - num * num7) * num3\n  let value = target + (num4 + num7) * num3\n  if (num5 - current > 0 === value > num5) {\n    value = num5\n    velocity = (value - num5) / deltaTime\n  }\n  return { value, velocity }\n}\n\nexport function map(num, start1, stop1, start2, stop2) {\n  return ((num - start1) / (stop1 - start1)) * (stop2 - start2) + start2\n}\n\nexport function clamp(num, min, max) {\n  if (min > max) [min, max] = [max, min]\n  return Math.min(Math.max(num, min), max)\n}\n\nexport function mapClamped(num, start1, stop1, start2, stop2) {\n  return map(clamp(num, start1, stop1), start1, stop1, start2, stop2)\n}\n\n//modulo operator, same as js remainder. but works with negative numbers.\nexport function modulo(num, mod) {\n  return ((num % mod) + mod) % mod\n}\n\nexport function dist(x1, y1, x2, y2) {\n  return Math.hypot(x1 - x2, y1 - y2)\n}\n\nexport function quotient(n, m) {\n  return ~~(n / m) * m\n}\n\nexport function random(a, b) {\n  if (arguments.length === 1) {\n    if (Array.isArray(a)) {\n      const index = Math.floor(random(a.length))\n\n      return a[index]\n    } else if (typeof a === 'object') {\n      return random(Object.values(a))\n    } else if (isNumber(a)) {\n      return Math.random() * a\n    }\n  } else if (arguments.length === 0) {\n    return Math.random()\n  }\n\n  return Math.random() * (b - a) + a\n}\n\nexport function isNumber(elem) {\n  return !(isNaN(elem) || elem === null)\n}\n","export async function delay(millis) {\n  return await new Promise((resolve) => globalThis.setTimeout(resolve, millis))\n}\n\nexport class Clock {\n  constructor() {\n    this.time = this.getTime()\n  }\n  getTime() {\n    return globalThis.window ? performance.now() : Date.now()\n  }\n  delta() {\n    const timeNow = this.getTime()\n    const deltaTime = timeNow - this.time\n    this.time = timeNow\n    return deltaTime\n  }\n}\n\nexport function throttle(callback, millis) {\n  let event\n  let timestamp = -millis\n  let wait = null\n\n  return (e) => {\n    event = e\n    if (wait !== null) return\n\n    wait = Math.min(Math.max(timestamp + millis - Date.now(), 0), millis)\n\n    globalThis.setTimeout(() => {\n      callback(event)\n      wait = null\n      timestamp = Date.now()\n    }, wait)\n  }\n}\n","import { lerp, smoothDamp, mapClamped, modulo } from './math'\nimport { Clock } from './time'\n\nexport class Smoother {\n  constructor(options) {\n    this.settings = {\n      value: 0,\n      target: 0,\n      ...options,\n    }\n\n    this.velocity = 0\n    this.value = this.target = this.settings.value\n  }\n  update() {\n    return this.value\n  }\n  setTarget(target = this.target) {\n    this.target = target\n  }\n  valueOf() {\n    return this.value\n  }\n}\n\nexport class Spring extends Smoother {\n  constructor(options) {\n    super({\n      drag: 0.75,\n      strength: 0.1,\n      ...options,\n    })\n  }\n\n  update(target) {\n    super.setTarget(target)\n    const { strength, drag } = this.settings\n\n    let force = this.target - this.value\n    force *= strength\n\n    this.velocity *= drag\n    this.velocity += force\n\n    this.value += this.velocity\n\n    return this.value\n  }\n}\n\nexport class Lerper extends Smoother {\n  constructor(options) {\n    super({\n      amount: 0.05,\n      ...options,\n    })\n  }\n\n  update(target) {\n    super.setTarget(target)\n    this.value = lerp(this.value, this.target, this.settings.amount)\n    return this.value\n  }\n}\n\nexport class SmoothDamper extends Smoother {\n  constructor(options) {\n    super({\n      smoothTime: 1,\n      maxSpeed: Infinity,\n      ...options,\n    })\n    this.clock = new Clock()\n  }\n\n  update(target, deltaTime = this.clock.delta()) {\n    super.setTarget(target)\n    const { smoothTime, maxSpeed } = this.settings\n    const results = smoothDamp(\n      this.value,\n      this.target,\n      this.velocity,\n      smoothTime,\n      maxSpeed,\n      deltaTime\n    )\n    this.value = results.value\n    this.velocity = results.velocity\n    return this.value\n  }\n}\n\n// https://morethandev.hashnode.dev/demystifying-the-cubic-bezier-function-ft-javascript\nexport function cubicBezier(t, initial, p1, p2, final) {\n  return (\n    (1 - t) * (1 - t) * (1 - t) * initial +\n    3 * (1 - t) * (1 - t) * t * p1 +\n    3 * (1 - t) * t * t * p2 +\n    t * t * t * final\n  )\n}\n\nfunction ease(t, easing, tolerance) {\n  tolerance *= 0.5\n  t = mapClamped(t, tolerance, 1 - tolerance, 0, 1)\n  // return (1 - (Math.cos(t * PI) * 0.5 + 0.5))\n  return cubicBezier(t, easing, 0, 1 - easing, 1)\n}\n\nexport function snap(\n  value,\n  dist,\n  { start = 0, tolerance = 0, easing = 0.5 } = {}\n) {\n  let t = (value + start) / dist\n  return (Math.floor(t) + ease(modulo(t, 1), easing, tolerance)) * dist - start\n}\n","export function remove(arr, elem) {\n  const index = arr.indexOf(elem)\n  if (index === -1) return false\n  arr.splice(index, 1)\n  return true\n}\n\nexport function fill(amount, entry) {\n  return new Array(amount).fill(entry)\n}\n\nexport function last(arr) {\n  return arr[arr.length - 1]\n}\n\nexport function range(start = 0, stop, step = 1) {\n  if (stop === undefined) [start, stop] = [0, start]\n\n  start -= step\n  return {\n    [Symbol.iterator]: () => ({\n      next: () => ({\n        value: (start += step),\n        done: start >= stop,\n      }),\n    }),\n  }\n}\n","import { map } from './math.js'\n\nexport function screenToWorld(\n  ctxOrMatrix,\n  x,\n  y,\n  { pixelDensity = devicePixelRatio } = {}\n) {\n  if (ctxOrMatrix instanceof CanvasRenderingContext2D)\n    ctxOrMatrix = ctxOrMatrix.getTransform()\n\n  const imatrix = ctxOrMatrix.invertSelf()\n\n  x *= pixelDensity\n  y *= pixelDensity\n\n  return {\n    x: x * imatrix.a + y * imatrix.c + imatrix.e,\n    y: x * imatrix.b + y * imatrix.d + imatrix.f,\n  }\n}\n\nexport function worldToScreen(\n  ctxOrMatrix,\n  oldX,\n  oldY,\n  { pixelDensity = devicePixelRatio } = {}\n) {\n  if (ctxOrMatrix instanceof CanvasRenderingContext2D)\n    ctxOrMatrix = ctxOrMatrix.getTransform()\n\n  const { x, y } = ctxOrMatrix.transformPoint(new DOMPoint(oldX, oldY))\n  return { x: x / pixelDensity, y: y / pixelDensity }\n}\n\nexport function skew(ctx, x, y) {\n  return ctx.transform(1, Math.tan(y), Math.tan(x), 1, 0, 0)\n}\n\nexport function crop(\n  source,\n  x1 = 0,\n  y1 = 0,\n  x2 = source.width,\n  y2 = source.height\n) {\n  const canvas = document.createElement('canvas')\n  const ctx = canvas.getContext('2d')\n  const x = Math.min(x1, x2)\n  const y = Math.min(y1, y2)\n  const width = Math.abs(x2 - x1)\n  const height = Math.abs(y2 - y1)\n\n  canvas.width = width\n  canvas.height = height\n\n  ctx.drawImage(source, x, y, width, height, 0, 0, width, height)\n\n  return canvas\n}\n\nexport function grid(ctx, x, y, w, h, columns = 1, rows = 1) {\n  let x1 = x,\n    y1 = y,\n    x2 = x + w,\n    y2 = y + h\n\n  ctx.beginPath()\n\n  for (let row = 0; row <= rows; row++) {\n    const y = map(row, 0, rows, y1, y2)\n    ctx.moveTo(x1, y)\n    ctx.lineTo(x2, y)\n  }\n\n  for (let column = 0; column <= columns; column++) {\n    const x = map(column, 0, columns, x1, x2)\n    ctx.moveTo(x, y1)\n    ctx.lineTo(x, y2)\n  }\n}\n\nexport function rotateFrom(ctx, x, y, angle) {\n  ctx.translate(x, y)\n  ctx.rotate(angle)\n  ctx.translate(-x, -y)\n}\n\n// https://stackoverflow.com/questions/7054272/how-to-draw-smooth-curve-through-n-points-using-javascript-html5-canvas\n// origPoints = [[x, y], [x, y], [x, y], ...]\nexport function smoothenPath(origPoints, { tension = 0.5, quality = 16 } = {}) {\n  const points = [...origPoints]\n  const res = [] // clone array\n  points.unshift(origPoints[0])\n  points.push(origPoints[origPoints.length - 1])\n\n  for (let i = 1; i < points.length - 2; i++) {\n    for (let t = 0; t <= quality; t++) {\n      const curr = points[i]\n      const next1 = points[i + 1]\n      const next2 = points[i + 2]\n      const prev1 = points[i - 1]\n      const t1x = (next1[0] - prev1[0]) * tension\n      const t2x = (next2[0] - curr[0]) * tension\n\n      const t1y = (next1[1] - prev1[1]) * tension\n      const t2y = (next2[1] - curr[1]) * tension\n\n      // calc step\n      const st = t / quality\n\n      // calc cardinals\n      const c1 = 2 * Math.pow(st, 3) - 3 * Math.pow(st, 2) + 1\n      const c2 = -(2 * Math.pow(st, 3)) + 3 * Math.pow(st, 2)\n      const c3 = Math.pow(st, 3) - 2 * Math.pow(st, 2) + st\n      const c4 = Math.pow(st, 3) - Math.pow(st, 2)\n\n      const x = c1 * curr[0] + c2 * next1[0] + c3 * t1x + c4 * t2x\n      const y = c1 * curr[1] + c2 * next1[1] + c3 * t1y + c4 * t2y\n\n      //store points in array\n      res.push([x, y])\n    }\n  }\n\n  return res\n}\n","export function getIndex(domElement) {\n  return [...domElement.parentElement.children].indexOf(domElement)\n}\n\nexport function queryAll(selector, parent = document) {\n  return parent.querySelectorAll(selector)\n}\n\nexport function query(selector, parent = document) {\n  return parent.querySelector(selector)\n}\n\nexport function setVariableFontSettings(domElement, fontAxes) {\n  const value = Object.entries(fontAxes)\n    .map(([key, value]) => `\"${key}\" ${value}`)\n    .join(', ')\n\n  domElement.style.setProperty('font-variation-settings', value)\n}\n","export async function loadJSON(url) {\n  return await globalThis.fetch(url).then((response) => {\n    if (!response.ok) throw new Error(response.statusText)\n    return response.json()\n  })\n}\n","export function iterate(obj, callback, method = 'map') {\n  const func = ([key, value]) => [key, callback(value, key, obj)]\n  return Object.fromEntries(Object.entries(obj)[method](func) || {})\n}\n\nexport function deepClone(obj) {\n  // console.warn('deepClone() is deprecated, use structuredClone() instead')\n  return JSON.parse(JSON.stringify(obj))\n}\n\nexport function* Enum(a, b = []) {\n  let i = 0\n  while (true) {\n    let v\n    if (arguments.length === 0) v = Symbol()\n    else if (\n      typeof a === 'function' &&\n      !(a.prototype && a.prototype.constructor === a)\n    ) {\n      v = a.call(this, i)\n    } else {\n      v = a\n    }\n    b.push(v)\n    i++\n    yield v\n  }\n}\n\nexport function monkeyPatcher(element, property, { getter, setter }) {\n  const original = Object.getOwnPropertyDescriptor(element, property)\n  Object.defineProperty(element, property, {\n    get() {\n      return getter(original.get.bind(this))\n    },\n    set(...values) {\n      setter(original.set.bind(this), ...values)\n    },\n  })\n}\n","export function capitalize(string) {\n  return string.charAt(0).toUpperCase() + string.slice(1)\n}\n\nexport function isWhiteSpaceOnly(str) {\n  return str.trim().length === 0\n}\n\nexport function encapsulate(\n  string,\n  prefix,\n  substring,\n  suffix,\n  { caseSensitive } = {}\n) {\n  const modifier = caseSensitive ? 'g' : 'gi'\n  const regExp = new RegExp(`(${substring})`, modifier)\n  return string.replace(regExp, `${prefix}$1${suffix}`)\n}\n","/**\n * Get a value from local storage.\n *\n * @param {string} key - The key of the value to retrieve.\n * @param {any} [def] - The default value to return if the key does not exist in local storage.\n * @returns {any} The value stored in local storage, or the default value if the key does not exist.\n */\nexport function getLocal(key, def) {\n  const elem = localStorage.getItem(key)\n  if (elem === null) return def\n  try {\n    return JSON.parse(elem)\n  } catch (e) {\n    return elem\n  }\n}\n\n/**\n * Set a value in local storage. If the value is `undefined`, remove the key from local storage.\n *\n * @param {string} key - The key to use when storing the value.\n * @param {any} [value] - The value to store. If the value is not a string, it will be stringified using JSON.stringify.\n * @returns {void}\n */\nexport function setLocal(key, value) {\n  if (value === undefined) return localStorage.removeItem(key)\n  if (typeof value !== 'string') value = JSON.stringify(value)\n  return localStorage.setItem(key, value)\n}\n","export class Deferred {\n  constructor() {\n    this.promise = new Promise((resolve, reject) => {\n      this.resolve = resolve\n      this.reject = reject\n    })\n  }\n}\n\n/**\n * Settle a promise.\n *\n * @param {Promise} promise - The promise to settle.\n * @returns {Object} An object with two properties:\n *   - `status`: either \"fulfilled\" or \"rejected\"\n *   - `value`: if `status` is \"fulfilled\", this is the resolved value of the promise\n *   - `reason`: if `status` is \"rejected\", this is the rejection reason for the promise\n * @async\n */\nexport async function settle(promise) {\n  try {\n    const value = await promise\n    return { status: 'fulfilled', value }\n  } catch (reason) {\n    return { status: 'rejected', reason }\n  }\n}\n","export function merge(...paths) {\n  return paths\n    .map((path) => sanitize(path))\n    .filter(Boolean)\n    .join('/')\n}\n\nexport function sanitize(path) {\n  return path.replace(/^\\/+|\\/+$/g, '')\n}\n","const NO_VALUE = undefined\n\n/**\n * Class adding functionalities to MapExtended.\n * @extends Map\n **/\n\nexport default class MapExtended extends Map {\n  /**\n   * Create a Map Extender.\n   * @param {number} x - The x value.\n   */\n  constructor() {\n    super(...arguments)\n  }\n\n  /**\n   * Rename a specific key.\n   * @param {*} oldKey - The old key.\n   * @param {*} newKey - The new key.\n   */\n  renameKey(oldKey, newKey) {\n    this.set(newKey, this.get(oldKey)).delete(oldKey)\n  }\n\n  /**\n   * Removes the first element and returns that removed element.\n   * @return {*} The removed element.\n   */\n  shift() {\n    const { value, done } = this.entries().next()\n    if (done) return NO_VALUE\n    this.delete(value[0])\n    return value\n  }\n\n  /**\n   * Removes the last element and returns that removed element.\n   * @return {*} The removed element.\n   */\n  pop() {\n    const value = [...this.entries()].pop()\n    if (!value) return NO_VALUE\n    this.delete(value[0])\n    return value\n  }\n\n  getOrCreate(key, value) {\n    let result = this.get(key)\n    if (result === undefined) {\n      this.set(key, value)\n      result = value\n    }\n    return result\n  }\n}\n"],"names":["lerp","start","stop","amount","TAU","Math","PI","QUARTER_PI","smoothDamp","current","target","velocity","smoothTime","maxSpeed","Infinity","deltaTime","num","num2","num3","num4","num5","num6","clamp","num7","value","map","start1","stop1","start2","stop2","min","max","mapClamped","modulo","mod","isNumber","elem","isNaN","degrees","radians","a","b","t","pow","x1","y1","x2","y2","hypot","n","m","random","arguments","length","Array","isArray","floor","Object","values","Clock","constructor","this","time","getTime","globalThis","window","performance","now","Date","delta","timeNow","async","millis","Promise","resolve","setTimeout","callback","event","timestamp","wait","e","Smoother","options","settings","update","setTarget","valueOf","cubicBezier","initial","p1","p2","final","super","drag","strength","force","clock","results","dist","tolerance","easing","ease","arr","index","indexOf","splice","entry","fill","step","undefined","Symbol","iterator","next","done","ctxOrMatrix","x","y","pixelDensity","devicePixelRatio","CanvasRenderingContext2D","getTransform","imatrix","invertSelf","c","d","f","oldX","oldY","transformPoint","DOMPoint","ctx","transform","tan","source","width","height","canvas","document","createElement","getContext","abs","drawImage","w","h","columns","rows","beginPath","row","moveTo","lineTo","column","angle","translate","rotate","origPoints","tension","quality","points","res","unshift","push","i","curr","next1","next2","prev1","t1x","t2x","t1y","t2y","st","c1","c2","c3","c4","domElement","parentElement","children","selector","parent","querySelectorAll","querySelector","fontAxes","entries","key","join","style","setProperty","url","fetch","then","response","ok","Error","statusText","json","obj","method","fromEntries","JSON","parse","stringify","v","prototype","call","element","property","getter","setter","original","getOwnPropertyDescriptor","defineProperty","get","bind","set","string","charAt","toUpperCase","slice","str","trim","prefix","substring","suffix","caseSensitive","regExp","RegExp","replace","def","localStorage","getItem","removeItem","setItem","promise","reject","status","reason","sanitize","path","paths","filter","Boolean","NO_VALUE","MapExtended","Map","renameKey","oldKey","newKey","delete","shift","pop","getOrCreate","result"],"mappings":"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"}